from pwn import *
import time
elf = ELF("./nono")
libc = ELF("./libc")
ld = ELF("./ld-2.31.so")
context.binary=elf
target=process([elf.path],env={"LD_PRELOAD":libc.path})
#target=remote()
context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

def exit():
	sla("Your input: ",str(5))

def play(index):
	sla("Your input: ",str(1))
	sla("Index:\n",str(index))

def add(title,size,puzzle):
	sla("Your input: ",str(2))
	sla("Title: ",title)
	sla("Size: ",str(size))
	sa("Puzzle: ",puzzle)

def delete(index):
	sla("Your input: ",str(3))
	sla("Index:\n",str(index))
	
def leaks(index=1):
	sla("Your input: ",str(4))
	sla("Index:\n",str(index))
	
pause()
add("c"*0x1,0x10,"C"*0x10)

target.interactive()
