from pwn import *
env={"LD_PRELOAD":"./libc.so.6"}
target=process(['/media/sf_kalishared/livectfs/tghack2020/Crap/ld-2.31.so','./detective'],env=env)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def alloc(index,size,data):
	print(target.recvuntil("> "))
	target.sendline(str(index))
	print(target.recvuntil("> "))
	target.sendline(str(size))
	print(target.recvuntil("> "))
	target.send(data)

def dealloc(index):
	print(target.recvuntil("> "))
	target.sendline(str(index))
	
def read(index,index2):
	print(target.recvuntil("> "))
	target.sendline(str(index))
	print(target.recvuntil("> "))
	target.sendline(str(index2))

pause()
target.interactive()


	
	
	
	
	
